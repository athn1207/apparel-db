# スクリーンショットから商品を登録する手順

タイトルが写っているスクショと、「項目：ブランド」が写っているスクショを一緒に置くと、**同一商品としてまとめてブランドとメルカリタイトル（商品名）を自動で読み取る**スクリプトが使えます。

---

## 仕組み

- **画面上部に途中まで見えるテキスト** を使って、複数枚のスクショを「同じ商品」としてグループ化します（タイトル用スクショとブランド用スクショをひも付けます）。
- 「**項目：ブランド**」が写っている画像から **ブランド名** を抽出します。このスクロール画面のスクショは**サイトには載せず、ブランド読み取り専用**です。
- **メルカリのタイトルをそのまま「商品名」として抜き出します。** サイズ・カラーなども含めたタイトル全文を1商品の商品名にします。
- **商品ごとに1件**として出力します。サイトではブランド一覧 → ブランドを選ぶとその下に商品一覧がぶら下がる形で表示されます。

---

## 手順

### 1. スクショを用意する

- **タイトルがはっきり見えるスクショ** を1枚以上
- **下にスクロールして「項目：ブランド」が写っているスクショ** を同じ商品ごとに1枚

同じ商品のスクショは **まとめて** `screenshots_input/` フォルダに入れます。複数商品を一度に処理する場合も、該当するスクショをすべてこのフォルダに入れてOKです。

### 2. 必要なライブラリを入れる（初回だけ）

ターミナルでプロジェクトのフォルダに移動してから:

```powershell
cd "c:\Users\akiko\OneDrive\デスクトップ\apparel-db"
pip install -r requirements-screenshots.txt
```

初回は EasyOCR のモデルダウンロードで少し時間がかかることがあります。

### 3. スクリプトを実行する

```powershell
python scripts/process_screenshots.py
```

- `screenshots_input/` 内の画像を読み、**上側のテキスト** で同一商品をグループ化します。
- 「ブランド」が含まれる画像からブランド名を抽出します（このスクショはサイトには載りません）。
- タイトル・商品が写っているスクショだけが **images/** にコピーされ、**suggested_products.json** の商品データに含まれます。

### 4. 結果を確認・修正する

- **suggested_products.json** を開き、商品名・ブランドが正しいか確認し、必要なら編集します。
- **data/data.json** を開き、既存の配列の **最後の商品の後ろにカンマ** を打ってから、suggested_products.json の各オブジェクトをコピーして追記します。
- 価格（price）や screenshot_count も必要に応じて直します。

### 5. サイトを更新する

```powershell
git add .
git commit -m "スクショから商品を追加"
git push
```

---

## フォルダ構成

| フォルダ / ファイル | 役割 |
|--------------------|------|
| **screenshots_input/** | 処理したいスクショをここに置く |
| **images/** | スクリプトがコピーした画像が入る（サイトで表示する画像） |
| **suggested_products.json** | スクリプトの出力。ここに「同商品」としてまとまった結果とブランドが入る |
| **data/data.json** | ここに suggested_products の内容を手動で追記してサイトに反映 |

---

## 座標固定で読み取る（必ずここを読む設定）

読み取り位置がずれてしまう場合は、**画像のどの範囲を読むか**を固定できます。

- プロジェクト直下に **screenshot_config.json** を置き、**ブランド**と**商品名**の範囲を「画像の幅・高さに対する割合（0〜1）」で指定します。
- 指定した四角の**外**のテキストは使わず、**中**のテキストだけでブランド・商品名を決めます。

詳しい書き方と割合の決め方は **SCREENSHOT_ZONE_CONFIG.md** を見てください。

---

## 注意

- OCR の精度の関係で、商品名・ブランドが少しずれることがあります。suggested_products.json で必ず目視確認・修正してください。
- **座標固定**を使うと、その範囲だけを読むので、ずれが減ります。
- 同じ商品のスクショは「上に商品名が途中まで見える」ようにしておくと、同一商品として認識されやすくなります。
