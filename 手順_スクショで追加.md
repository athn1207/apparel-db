# スクショから商品を追加するときの順番

この順番でやれば、商品がサイトに反映されます。

---

## 「できているか」を確認して進める

| 確認したいこと | やること | できている目安 |
|----------------|----------|----------------|
| **スクリプトが動くか** | **screenshots_input** にスクショを1枚入れ、ターミナルで `python scripts/process_screenshots.py` を実行する | エラーが出ずに「処理完了: ○ 商品にグループ化しました」と出る |
| **OCR が読めているか** | 実行後、**ocr_debug.json** を開く | **raw_brand_text** や **raw_product_text** に文字が入っている（空でない） |
| **商品名・ブランドが入っているか** | **suggested_products.json** を開く | **brand** が「その他」でない、**product_name** が「（商品名を編集してください）」でない |
| **サイトに反映する** | **data/data.json** に suggested_products.json の中身をコピーして保存し、`git add .` → `commit` → `push` | ブラウザでサイトを開いて、追加した商品が表示される |

- OCR が空（raw_* が ""）のときは、**suggested_products.json** を手動で編集してから data.json にコピーすれば進められます。
- エラーが出たときは、ターミナルに表示された **ERROR: Could not load image: …** や例外メッセージを確認してください。

---

## 初回だけ（1度やればOK）

1. **Tesseract を入れる**  
   - Windows: [Tesseract のインストール](https://github.com/UB-Mannheim/tesseract/wiki) から日本語＋英語を入れる。  
   - Mac: ターミナルで `brew install tesseract tesseract-lang`

2. **Python のライブラリを入れる**  
   ターミナルでプロジェクトのフォルダに移動してから:
   ```powershell
   cd "c:\Users\akiko\OneDrive\デスクトップ\apparel-db"
   pip install -r requirements-screenshots.txt
   ```

---

## 商品を追加するたびにやること

| 順番 | やること |
|------|----------|
| **1** | **screenshots_input** フォルダに、追加したい商品のスクショを入れる。<br>（1枚で「商品名」と「ブランド行」が写っていればOK。今の設定は 1 枚対応） |
| **2** | ターミナルで、**1行ずつ**実行する。<br>① `cd "c:\Users\akiko\OneDrive\デスクトップ\apparel-db"`<br>② `python scripts/process_screenshots.py` |
| **3** | 処理が終わったら **suggested_products.json** を開き、商品名・ブランドが正しいか確認。違っていればここで直す。 |
| **4** | **data/data.json** を開く。<br>・**最後の商品の `}` の直後**に **半角カンマ `,`** を打つ。<br>・**suggested_products.json** の `[` と `]` の**中身**（商品ブロック）をコピーして、そのカンマの後ろに貼り付ける。<br>・複数商品なら、ブロックとブロックの間も **半角カンマ** で区切る。<br>・最後は `]` で閉じ、カンマの付け忘れ・余分なカンマがないか確認する。 |
| **5** | サイトを更新する場合、ターミナルで **1行ずつ**実行。<br>① `git add .`<br>② `git commit -m "商品を追加"`<br>③ `git push` |

---

## 覚えておくこと

- **サイトに反映されるのは data/data.json だけ**です。suggested_products.json を直しても、**data.json にコピーしないと反映されません**。
- suggested_products.json はスクリプトを実行するたびに**上書き**されます。残したい結果は、data.json にコピーする前に別名で保存しておく。
- **OCR（Tesseract / EasyOCR）は、メルカリのスクショでは文字が崩れて読めないことがあります。** その場合は **商品名・ブランドを suggested_products.json で手動入力**してから data.json にコピーする運用にしてください。スクリプトの役割は「画像を1商品分にまとめて images/ にコピーし、suggested_products.json のひな形を作る」ことです。

---

## 手動で1件だけ追加したいとき

スクショを使わない場合は、**data/data.json** を開いて、最後の商品の `}` の直後にカンマを打ち、新しい商品ブロックを手で書く。詳しくは **ADD_STEPS.md** の「方法B」を見る。
